// Generated by CoffeeScript 1.3.3
(function(){var e,t,n=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};t=typeof exports!="undefined"&&exports!==null?exports:this,t.jColour=function(){function f(t){var n,i,s,o,a,f;t==null&&(t="#ffffff"),t.toLowerCase()in e&&(t=e[t]);if(o=t.match(/^#?([a-f0-9]{3})$/i))n=o[1].substring(0,1),i=o[1].substring(1,2),s=o[1].substring(2,3),t="#"+(n+n+i+i+s+s);if(o=t.match(/^#?([a-f0-9]{6,8})$/i))this.red=parseInt(o[1].substring(0,2),16),this.green=parseInt(o[1].substring(2,4),16),this.blue=parseInt(o[1].substring(4,6),16),this.alpha=o[1].substring(6,8)?parseInt(o[1].substring(6,8),16)/255:1,u(this);else if(f=t.match(/^rgba?\(\s*(\d+)[,\s]*(\d+)[,\s]*(\d+)[,\s]*([\.\d]+)?\s*\)$/i))this.red=parseInt(f[1]),this.green=parseInt(f[2]),this.blue=parseInt(f[3]),this.alpha=f[4]?f[4]:1,u(this);else{if(!(a=t.match(/^hsla?\(\s*(\d+)[,\s]*(\d+)[,\s]*(\d+)[,\s]*([\.\d]+)?\s*\)$/i)))throw"Invalid colour string.";this.hue=parseInt(a[1]),this.saturation=parseInt(a[2]),this.lightness=parseInt(a[3]),this.alpha=a[4]?a[4]:1,r(this)}}var e,t,r,i,s,o,u,a;return f.prototype.hex=function(e){var n;return e==null&&(e=!1),n=e&&this.alpha<1?"#"+t(this.red)+t(this.green)+t(this.blue)+t(this.alpha*255):"#"+t(this.red)+t(this.green)+t(this.blue),n.toLowerCase()},f.prototype.rgb=function(){return this.alpha===1?"rgb("+Math.round(this.red)+", "+Math.round(this.green)+", "+Math.round(this.blue)+")":"rgba("+Math.round(this.red)+", "+Math.round(this.green)+", "+Math.round(this.blue)+", "+Math.round(this.alpha*100)/100+")"},f.prototype.hsl=function(){return this.alpha===1?"hsl("+Math.round(this.hue)+", "+Math.round(this.saturation)+", "+Math.round(this.lightness)+")":"hsla("+Math.round(this.hue)+", "+Math.round(this.saturation)+", "+Math.round(this.lightness)+", "+Math.round(this.alpha*100)/100+")"},f.prototype.toS=function(){var t,n;for(t in e){n=e[t];if(this.hex()===n.toLowerCase())return t}return this.hex()},f.prototype.lighten=function(e){return this.lightness+=e,r(this)},f.prototype.lightenPercent=function(e){return this.lightness+=this.lightness/100*e,r(this)},f.prototype.darken=function(e){return this.lightness-=e,r(this)},f.prototype.darkenPercent=function(e){return this.lightness-=this.lightness/100*e,r(this)},f.prototype.saturate=function(e){return this.saturation+=e,r(this)},f.prototype.saturatePercent=function(e){return this.saturation+=this.saturation/100*e,r(this)},f.prototype.desaturate=function(e){return this.saturation-=e,r(this)},f.prototype.desaturatePercent=function(e){return this.saturation-=this.saturation/100*e,r(this)},f.prototype.greyscale=function(){return this.saturation=0,r(this)},f.prototype.grayscale=function(){return this.greyscale()},f.prototype.adjustHue=function(e){return this.hue+=e,r(this)},f.prototype.complement=function(){return this.hue+=180,r(this)},f.prototype.opacify=function(e){return this.alpha+=e,this.alpha=s(this.alpha,0,1),this},f.prototype.transparentize=function(e){return this.alpha-=e,this.alpha=s(this.alpha,0,1),this},f.prototype.invert=function(){var e,t,n,r;r=["red","green","blue"];for(t=0,n=r.length;t<n;t++)e=r[t],this[e]=255-this[e];return u(this)},f.prototype.adjustColour=function(e){var t,i;e==null&&(e={}),i=a(e);for(t in e)n.call(o,t)>=0&&(this[t]+=e[t]);return i[0]?u(this):r(this)},f.prototype.scaleColour=function(e){var t,i;e==null&&(e={}),i=a(e);for(t in e)n.call(o,t)>=0&&t!=="hue"&&(this[t]+=this[t]/100*e[t]);return i[0]?u(this):r(this)},f.prototype.changeColour=function(e){var t,i;e==null&&(e={}),i=a(e);for(t in e)n.call(o,t)>=0&&(this[t]=e[t]);return i[0]?u(this):r(this)},f.prototype.mixWith=function(e,t){var n,r,i,s,o;return t==null&&(t=50),e instanceof f||(e=new f(e)),r=t/100,i=r*2-1,n=e.alpha-this.alpha,s=((i*n===-1?i:(i+n)/(1+i*n))+1)/2,o=1-s,this.red=e.red*s+this.red*o,this.green=e.green*s+this.green*o,this.blue=e.blue*s+this.blue*o,this.alpha=e.alpha*r+this.alpha*(1-r),u(this)},o=["red","green","blue","hue","saturation","lightness","alpha"],e={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},u=function(e){var t,n,r,i,o,u,a,f,l;return e.red=s(e.red,0,255),e.green=s(e.green,0,255),e.blue=s(e.blue,0,255),e.alpha=s(e.alpha,0,1),f=e.red/255,r=e.green/255,t=e.blue/255,u=Math.max(f,r,t),a=Math.min(f,r,t),n=u-a,i=function(){switch(u){case a:return 0;case f:return 60*(r-t)/n;case r:return 60*(t-f)/n+120;case t:return 60*(f-r)/n+240}}(),o=(u+a)/2,l=u===a?0:o<.5?n/(2*o):n/(2-2*o),e.hue=i%360,e.saturation=l*100,e.lightness=o*100,e},r=function(e){var t,n,r,o,u,a,f,l;return e.hue>=360&&(e.hue-=Math.floor(e.hue/360)*360),e.hue<0&&(e.hue-=Math.ceil(e.hue/360)*360),e.saturation=s(e.saturation,0,100),e.lightness=s(e.lightness,0,100),e.alpha=s(e.alpha,0,1),r=e.hue/360,l=e.saturation/100,o=e.lightness/100,a=o<.5?o*(l+1):o+l-o*l,u=o*2-a,f=i(u,a,r+1/3),n=i(u,a,r),t=i(u,a,r-1/3),e.red=f*255,e.green=n*255,e.blue=t*255,e},i=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(2/3-n)*6:e},t=function(e){return e==null&&(e="00"),e=parseInt(e),e===0||isNaN(e)?"00":(e=Math.round(s(e,0,255)),"0123456789ABCDEF".charAt((e-e%16)/16)+"0123456789ABCDEF".charAt(e%16))},s=function(e,t,n){return Math.min(Math.max(e,t),n)},a=function(e){var t,n,r;r=t=!1;for(n in e){if(n==="red"||n==="green"||n==="blue")r=!0;if(n==="hue"||n==="saturation"||n==="luminosity")t=!0}if(r&&t)throw"Cannot change both RGB and HSL properties.";return[r,t]},f}(),function(){var e,t,n,r,i;e=0,n=["ms","moz","webkit","o"];if(!window.requestAnimationFrame)for(r=0,i=n.length;r<i;r++)t=n[r],window.requestAnimationFrame=window[t+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t+"CancelAnimationFrame"]||window[t+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t,n){var r,i,s;return r=(new Date).getTime(),s=Math.max(0,16-(r-e)),i=window.setTimeout(function(){return t(r+s)},s),e=r+s,i});if(!window.cancelAnimationFrame)return window.cancelAnimationFrame=function(e){return clearTimeout(e)}}(),CanvasRenderingContext2D.prototype.pinShape=function(e,t,n,r,i,s){var o,u;i==null&&(i=!1),s==null&&(s=!1),u={x:e+n/2,y:t+r/2},o={y:t+r/3},this.beginPath(),this.arc(u.x,t+r/3,n/2,Math.PI,0,!1),this.bezierCurveTo(e+n,o.y+r/4,u.x+n/3,u.y,u.x,t+r),this.moveTo(e,o.y),this.bezierCurveTo(e,o.y+r/4,u.x-n/3,u.y,u.x,t+r),i&&this.fill();if(s)return this.stroke()},e=function(){function e(){this.maps=[]}return e.prototype.createMap=function(t){var n;return n=new e.Map(t),this.maps.push(n),n},e}(),e.Util=function(){function e(e){this.color=e}return e}(),e.Map=function(){function t(e){this.options=e,this.container=this.options.container,this.markers=[],this.map=new google.maps.Map(document.getElementById(this.container),this.options)}return t.prototype.addMarker=function(t){var n;return n=new e.MapMarker(t),this.markers.push(n),n},t.prototype.showMarkers=function(){var e,t,n,r,i;r=this.markers,i=[];for(t=0,n=r.length;t<n;t++)e=r[t],i.push(e.setMap(this.map));return i},t.prototype.fitToMarkers=function(e){var t,n,r,i;e=e||this.markers,t=new google.maps.LatLngBounds;for(r=0,i=e.length;r<i;r++)n=e[r],t.extend(n.marker.getPosition());return this.map.fitBounds(t)},t}(),e.MapMarker=function(){function e(e){var t;this.options=e,this.latitude=this.options.latitude||60,this.longitude=this.options.longitude||24,this.color=new jColour(this.options.color||"#f00"),this.size=this.options.size||24,this.width=this.size,this.height=this.size*1.5,this.minSize=this.size,this.maxSize=this.size*2,this.isGrown=!1,this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),t={position:new google.maps.LatLng(this.latitude,this.longitude),title:this.options.title||"Untitled Marker",animation:this.options.animation||null},this.marker=new google.maps.Marker(t),this.options.map!=null&&(this.marker.setMap(this.options.map),this.render())}return e.prototype.setMap=function(e){return this.marker.setMap(e)},e.prototype.render=function(){return this.canvas.width=this.width,this.canvas.height=this.height+this.size/4,this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.icon=this.createIcon(),this.marker.setIcon(this.icon)},e.prototype.createIcon=function(){var e,t,n,r,i,s,o,u,a,f,l;this.drawShadow(),e=new jColour(this.color.rgb()),n={start:e.lighten(5.5).hex(),end:e.darken(10).hex()},t=this.context.createLinearGradient(0,0,this.width,this.height),t.addColorStop(0,n.start),t.addColorStop(1,n.end),r=new jColour(this.color.rgb()),s={start:r.darken(10).transparentize(90).hex(),end:r.darken(15).transparentize(90).hex()},i=this.context.createLinearGradient(0,0,this.width,this.height),i.addColorStop(0,s.start),i.addColorStop(1,s.end),this.context.lineWidth=1.5,u=[[1.5,0,this.width-3.5,this.height,t,i],[2,1,this.width-4.25,this.height-2.5,(new jColour(this.color.rgb())).lighten(25).hex(),!1],[2,2.5,this.width-4.25,this.height-4,t,!1]];for(a=0,f=u.length;a<f;a++)o=u[a],this.context.fillStyle=o[4]?o[4]:!1,this.context.strokeStyle=o[5]?o[5]:!1,(l=this.context).pinShape.apply(l,o);return this.context.beginPath(),this.context.arc(this.width/2,this.height/3,this.width/6,Math.PI*2,0,!1),this.context.fillStyle="#fff",this.context.fill(),new google.maps.MarkerImage(this.canvas.toDataURL(),new google.maps.Size(this.width,this.canvas.height,new google.maps.Point(0,0,new google.maps.Point(this.width/2,this.height))))},e.prototype.drawShadow=function(){var e,t,n,r;return r={width:this.width/2,height:this.width/2},n={x:this.width/2-r.width/2,y:this.height-r.height},e={x:n.x+r.width/2,y:n.y+r.height/2},t=this.context.createRadialGradient(e.x,e.y,0,e.x,e.y,r.width/2),t.addColorStop(0,"rgba(0, 0, 0, 0.30)"),t.addColorStop(1,"rgba(0, 0, 0, 0)"),this.context.setTransform(1,0,0,.5,0,0),this.context.translate(0,this.height+r.height/2),this.context.fillStyle=t,this.context.fillRect(n.x,n.y,r.width,r.height),this.context.fill(),this.context.closePath(),this.context.setTransform(1,0,0,1,0,0)},e.prototype.drawPinShape=function(e,t,n,r,i,s){var o,u;u={x:e+n/2,y:e+r/2},o={y:t+r/3},this.context.beginPath(),this.context.arc(this.center.x,t+r/3,n/2,Math.PI,0,!1),this.context.bezierCurveTo(e+n,o.y+r/4,u.x+n/3,u.y,u.x,t+r),this.context.moveTo(e,o.bottom),this.context.bezierCurveTo(e,o.y+r/4,u.x-n/3,u.y,u.y,t+r),i&&(this.context.fillStyle=i,this.context.fill());if(s)return this.context.strokeStyle=s,this.context.stroke()},e.prototype.animateSize=function(e,t,n){var r,i=this;this.minSize=t,this.maxSize=n;if(this.isGrown&&e<=this.minSize){this.isGrown=!1;return}if(!this.isGrown&&size>=this.maxSize){this.isGrown=!0;return}return r=this.isGrown?e-1:e+1,this.width=r,this.height=r*1.5,requestAnimationFrame(function(){return i.animateSize(r,t,n)})},e}(),window.Atlas=e}).call(this);